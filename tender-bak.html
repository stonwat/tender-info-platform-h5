<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>招标信息平台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <!-- Tailwind配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#4080FF',
                        neutral: '#6B7280',
                        light: '#F5F7FA',
                        dark: '#1D2129',
                        success: '#00B42A',
                        warning: '#FF7D00',
                        danger: '#F53F3F'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                },
            }
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .card-hover {
        @apply transition-all duration-300 hover:shadow-md;
      }
      .fade-in {
        animation: fadeIn 0.3s ease-in-out;
      }
      .skeleton-loading {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(5px); }
        to { opacity: 1; transform: translateY(0); }
      }
      @keyframes loading {
        0% { background-position: 200% 0; }
        100% { background-position: -200% 0; }
      }
      .scroll-indicator {
        height: 4px;
        background: linear-gradient(to right, #165DFF, #4080FF);
        position: fixed;
        top: 0;
        left: 0;
        z-index: 100;
        transition: width 0.2s ease;
      }
      .error-toast {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #F53F3F;
        color: white;
        padding: 8px 16px;
        border-radius: 4px;
        z-index: 1000;
        animation: fadeIn 0.3s, fadeOut 0.3s 3s forwards;
      }
      .status-badge {
        @apply px-1.5 py-0.5 text-xs rounded;
      }
      .status-bidding {
        @apply bg-green-100 text-green-800;
      }
      .status-closed {
        @apply bg-red-100 text-red-800;
      }
      .status-won {
        @apply bg-blue-100 text-blue-800;
      }
      .no-more-data {
        @apply py-4 text-center text-sm text-neutral;
      }
      .date-filter.active {
        @apply bg-primary text-white;
      }
      .skeleton-card {
        @apply bg-gray-100 rounded-xl p-4;
      }
      .skeleton-line {
        @apply h-4 bg-gray-200 rounded mb-3;
      }
      @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
      }
      .serial-number {
        @apply flex items-center justify-center w-8 h-8 bg-primary/10 text-primary rounded-lg text-base font-medium;
      }
    }
  </style>
</head>

<body class="bg-gray-50 font-inter text-dark min-h-screen">
    <div id="app">
        <!-- 顶部滚动指示器 -->
        <div class="scroll-indicator" id="scrollIndicator"></div>

        <!-- 导航栏 -->
        <header class="bg-white shadow-sm sticky top-0 z-50">
            <div class="container mx-auto px-4 py-3 flex items-center justify-between">
                <h1 class="text-lg font-bold">招标信息平台</h1>
                <div class="flex items-center gap-3">
                    <button id="refreshBtn" class="text-neutral hover:text-primary transition-colors">
                        <i class="fa fa-refresh"></i>
                    </button>
                    <button id="filterBtn" class="text-neutral hover:text-primary transition-colors">
                        <i class="fa fa-filter"></i>
                    </button>
                </div>
            </div>

            <!-- 搜索框和地区筛选 -->
            <div class="px-4 pb-3">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <div class="relative col-span-2">
                        <input id="searchInput" type="text" placeholder="搜索招标文件..."
                            class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary">
                        <i class="fa fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    </div>

                    <!-- 地区筛选下拉框 -->
                    <div class="relative">
                        <select id="areaSelect"
                            class="w-full pl-3 pr-8 py-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary appearance-none bg-white">
                            <option value="">全部地区</option>
                            <option value="大庆">大庆</option>
                            <option value="佳木斯">佳木斯</option>
                            <option value="哈尔滨">哈尔滨</option>
                            <option value="齐齐哈尔">齐齐哈尔</option>
                            <option value="牡丹江">牡丹江</option>
                            <option value="绥化">绥化</option>
                            <option value="鸡西">鸡西</option>
                            <option value="鹤岗">鹤岗</option>
                            <option value="双鸭山">双鸭山</option>
                            <option value="伊春">伊春</option>
                            <option value="七台河">七台河</option>
                            <option value="黑河">黑河</option>
                            <option value="大兴安岭">大兴安岭地区</option>
                        </select>
                        <i
                            class="fa fa-chevron-down absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
                    </div>
                </div>
            </div>

            <!-- 筛选面板（日期筛选） -->
            <div id="filterPanel" class="px-4 pb-3 border-t border-gray-100 hidden">
                <div class="flex flex-wrap gap-2">
                    <button class="date-filter active px-3 py-1 rounded-full text-sm bg-primary text-white"
                        data-filter="all">全部</button>
                    <button
                        class="date-filter px-3 py-1 rounded-full text-sm bg-gray-100 text-neutral hover:bg-gray-200 transition-colors"
                        data-filter="today">今天</button>
                    <button
                        class="date-filter px-3 py-1 rounded-full text-sm bg-gray-100 text-neutral hover:bg-gray-200 transition-colors"
                        data-filter="week">本周</button>
                    <button
                        class="date-filter px-3 py-1 rounded-full text-sm bg-gray-100 text-neutral hover:bg-gray-200 transition-colors"
                        data-filter="month">本月</button>
                    <button
                        class="date-filter px-3 py-1 rounded-full text-sm bg-gray-100 text-neutral hover:bg-gray-200 transition-colors"
                        data-filter="threeMonths">三个月内</button>
                </div>
            </div>
        </header>

        <!-- 主体内容 -->
        <main class="container mx-auto px-4 py-4">
            <!-- 筛选标签（显示当前选中的地区和日期筛选条件） -->
            <div id="filterTags" class="flex flex-wrap gap-2 mb-4 hidden">
                <!-- 地区标签 -->
                <span id="areaTag" class="px-2 py-1 bg-primary/10 text-primary text-xs rounded-full flex items-center">
                    地区：<span class="ml-1 area-tag-value">大庆</span>
                    <button class="ml-1 text-primary/70 hover:text-primary"><i class="fa fa-times-circle"></i></button>
                </span>

                <!-- 日期标签 -->
                <span id="dateTag" class="px-2 py-1 bg-primary/10 text-primary text-xs rounded-full flex items-center">
                    时间：<span class="ml-1 date-tag-value">本周</span>
                    <button class="ml-1 text-primary/70 hover:text-primary"><i class="fa fa-times-circle"></i></button>
                </span>

                <!-- 清除全部按钮 -->
                <button id="clearAllFilters" class="text-xs text-neutral hover:text-primary">
                    清除全部
                </button>
            </div>

            <!-- 列表计数 -->
            <div class="text-xs text-neutral mb-4 flex justify-between items-center">
                <span>共找到 <span id="totalCount" class="text-primary font-medium">0</span> 条信息</span>
                <span id="displayRange" class="hidden">显示 0-0 条</span>
            </div>

            <!-- 列表内容 -->
            <ul id="tenderList" class="space-y-3">
                <!-- 加载状态 -->
                <li id="loadingIndicator" class="py-8 text-center">
                    <div
                        class="inline-block animate-spin rounded-full h-8 w-8 border-4 border-primary border-t-transparent">
                    </div>
                    <p class="mt-2 text-sm text-neutral">加载中...</p>
                </li>
            </ul>
        </main>

        <!-- 页脚 -->
        <footer class="py-4 text-center text-xs text-neutral border-t border-gray-100">
            <p>© 2025 招标信息平台. 保留所有权利.</p>
        </footer>

        <!-- 回到顶部按钮 -->
        <button id="backToTopBtn"
            class="fixed bottom-6 right-6 bg-primary text-white w-10 h-10 rounded-full shadow-lg flex items-center justify-center transition-all z-50 opacity-0 invisible">
            <i class="fa fa-arrow-up"></i>
        </button>
    </div>

    <script>
        // 应用状态
        const appState = {
            tenders: [],
            currentPage: 1,
            itemsPerPage: 10,
            totalItems: 0,
            isLoading: true,
            hasMore: true,
            activeFilter: 'all',
            filterStartDate: null,
            filterEndDate: null,
            searchQuery: '',
            selectedArea: '',
            // apiBaseUrl: 'http://localhost:8088/api/tenders'
            apiBaseUrl: 'http://117.72.196.106:8088/api/tenders'
        };

        // DOM 元素
        const elements = {
            tenderList: document.getElementById('tenderList'),
            loadingIndicator: document.getElementById('loadingIndicator'),
            emptyState: null,
            totalCount: document.getElementById('totalCount'),
            displayRange: document.getElementById('displayRange'),
            searchInput: document.getElementById('searchInput'),
            refreshBtn: document.getElementById('refreshBtn'),
            filterBtn: document.getElementById('filterBtn'),
            filterPanel: document.getElementById('filterPanel'),
            dateFilters: document.querySelectorAll('.date-filter'),
            reloadBtn: null,
            backToTopBtn: document.getElementById('backToTopBtn'),
            scrollIndicator: document.getElementById('scrollIndicator'),
            areaSelect: document.getElementById('areaSelect'),
            filterTags: document.getElementById('filterTags'),
            areaTag: document.getElementById('areaTag'),
            dateTag: document.getElementById('dateTag'),
            areaTagText: document.querySelector('.area-tag-value'),
            dateTagText: document.querySelector('.date-tag-value'),
            clearAllFilters: document.getElementById('clearAllFilters'),
            areaTagClose: document.querySelector('#areaTag button'),
            dateTagClose: document.querySelector('#dateTag button')
        };

        // 初始化应用
        function initApp() {
            // 从URL获取地区参数
            const urlParams = new URLSearchParams(window.location.search);
            const areaFromUrl = urlParams.get('area');
            if (areaFromUrl) {
                appState.selectedArea = areaFromUrl;
                elements.areaSelect.value = areaFromUrl;
            }

            loadInitialData();
            setupEventListeners();
        }

        // 加载初始数据
        function loadInitialData() {
            setLoading(true);
            appState.currentPage = 1;

            // 显示骨架屏
            showSkeletonLoading();

            fetchTenderData()
                .then(data => {
                    appState.tenders = data.content;
                    appState.totalItems = data.totalElements;
                    console.log(appState.currentPage,'appState.currentPage0')
                    appState.hasMore = (appState.currentPage * appState.itemsPerPage) < appState.totalItems;
                    renderTenders();
                    setLoading(false);
                    updateFilterTags();
                })
                .catch(error => {
                    console.error('加载数据失败:', error);
                    setLoading(false);
                    showEmptyState(true);
                    showErrorToast('加载数据失败，请稍后重试');
                });
        }

        // 使用Axios请求真实接口
        function fetchTenderData() {
            // 构建查询参数
            const params = {
                page: appState.currentPage - 1, // 后端从0开始
                size: appState.itemsPerPage,
                area: appState.selectedArea || undefined,
                startDate: appState.filterStartDate || undefined,
                endDate: appState.filterEndDate || undefined,
                keyword: appState.searchQuery.trim() || undefined
            };

            // 移除值为undefined的参数
            Object.keys(params).forEach(key =>
                params[key] === undefined && delete params[key]
            );

            return axios.get(`${appState.apiBaseUrl}/filter`, { params })
                .then(response => {
                    return response.data;
                })
                .catch(error => {
                    console.error('请求招标数据失败:', error.response?.data || error.message);
                    throw error;
                });
        }

        // 加载更多数据
        function loadMoreData() {
            if (appState.isLoading || !appState.hasMore) return;

            setLoading(true);
            appState.currentPage++;
            console.log(appState.tenders,'appState.tenders0',appState.currentPage)
            fetchTenderData()
                .then(data => {
                    appState.totalItems = data.totalElements;
                    appState.hasMore = (appState.currentPage * appState.itemsPerPage) < appState.totalItems;
                    console.log(appState.tenders,'appState.tenders1',data.content)
                    appState.tenders = [...data.content];
                    // appState.tenders.push(...data.content);
                    console.log(appState.tenders,'appState.tenders2',data.content)
                    renderTenders(true);
                    setLoading(false);
                })
                .catch(error => {
                    console.error('加载更多数据失败:', error);
                    setLoading(false);
                    appState.currentPage--;
                    showErrorToast('加载更多数据失败，请稍后重试');
                });
               
        }
        // 渲染招标信息列表
        function renderTenders(append = false) {
            console.log(appState.tenders,'appState.tenders3')
            const { tenders, currentPage, itemsPerPage, totalItems } = appState;
            console.log(tenders,'appState.tenders4')
            const start = (currentPage - 1) * itemsPerPage;
            const end = Math.min(start + itemsPerPage, totalItems);

            // 更新计数
            elements.totalCount.textContent = totalItems;

            // 更新显示范围
            if (totalItems > 0) {
                elements.displayRange.textContent = `显示 1-${end} 条`;
                elements.displayRange.classList.remove('hidden');
            } else {
                elements.displayRange.classList.add('hidden');
            }

            // 清空列表或保留加载指示器
            if (!append) {
                elements.tenderList.innerHTML = '';
            } else {
                // 移除加载指示器和"没有更多数据"提示
                const loadingIndicator = elements.tenderList.querySelector('.loading-indicator');
                const noMoreIndicator = elements.tenderList.querySelector('.no-more-data');
                if (loadingIndicator) loadingIndicator.remove();
                if (noMoreIndicator) noMoreIndicator.remove();
            }

            // 渲染列表项
            if (tenders.length > 0) {
                showEmptyState(false);

                tenders.forEach((tender, index) => {
                    const listItem = createTenderListItem(tender, index);
                    elements.tenderList.appendChild(listItem);
                });

                // 添加加载指示器或"没有更多数据"提示
                if (appState.hasMore) {
                    elements.tenderList.appendChild(createLoadingMoreIndicator());
                } else if (appState.currentPage > 1) {
                    // 只有在加载了多页数据后才显示"没有更多数据"
                    elements.tenderList.appendChild(createNoMoreDataIndicator());
                }
            } else {
                showEmptyState(true);
            }
        }

        // 创建招标信息列表项
        function createTenderListItem(tender, index) {
            const listItem = document.createElement('li');
            listItem.className = 'bg-white rounded-xl shadow-sm overflow-hidden card-hover fade-in';
            listItem.style.animationDelay = `${index * 0.05}s`;

            // 计算序号：(当前页码 - 1) * 每页数量 + 索引 + 1
            const { currentPage, itemsPerPage } = appState;
            const serialNumber = (currentPage - 1) * itemsPerPage + index + 1;

            // 构建详情页URL
            const detailUrl = `tender-detail.html?id=${tender.id}`;

            // 状态徽章
            let statusClass = 'status-bidding';
            let statusText = '招标中';

            if (tender.status === '已截止') {
                statusClass = 'status-closed';
                statusText = '已截止';
            } else if (tender.status === '已中标') {
                statusClass = 'status-won';
                statusText = '已中标';
            }

            listItem.innerHTML = `
        <a href="${detailUrl}" class="block p-4">
          <div class="flex items-start gap-3">
            <div class="serial-number">${serialNumber}</div>
            <div class="bg-primary/10 text-primary p-2 rounded-lg">
              <i class="fa fa-file-text-o text-lg"></i>
            </div>
            <div class="flex-grow">
              <h3 class="font-medium text-base mb-1 line-clamp-2">${tender.name}</h3>
              <div class="flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-neutral">
                <span><i class="fa fa-map-marker text-primary mr-1"></i>${tender.area}</span>
                <span><i class="fa fa-calendar-o mr-1"></i>${formatDate(tender.date)}</span>
                <span class="status-badge ${statusClass}">${statusText}</span>
              </div>
            </div>
            <i class="fa fa-angle-right text-neutral self-center"></i>
          </div>
        </a>
      `;

            return listItem;
        }

        // 创建加载更多指示器
        function createLoadingMoreIndicator() {
            const indicator = document.createElement('li');
            indicator.className = 'py-4 text-center loading-indicator';
            indicator.innerHTML = `
        <p class="text-sm text-neutral">
          <i class="fa fa-angle-down mr-1 animate-bounce"></i> 上拉加载更多
        </p>
      `;
            return indicator;
        }
        
        // 创建"没有更多数据"指示器
        function createNoMoreDataIndicator() {
            const indicator = document.createElement('li');
            indicator.className = 'no-more-data';
            indicator.innerHTML = `
                <div class="inline-flex items-center gap-2">
                  <i class="fa fa-check-circle text-success"></i>
                  <span>已加载全部数据</span>
                </div>
            `;
            return indicator;
        }

        // 格式化日期显示
        function formatDate(dateString) {
            if (!dateString) return '';

            // 处理LocalDate格式 (如 "2023-08-15")
            if (typeof dateString === 'string' && dateString.includes('-')) {
                return dateString;
            }

            // 处理Date对象
            const date = new Date(dateString);
            return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
        }

        // 显示骨架屏加载效果
        function showSkeletonLoading() {
            elements.tenderList.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const skeleton = document.createElement('li');
                skeleton.className = 'skeleton-card animate-pulse';
                skeleton.innerHTML = `
                    <div class="skeleton-line w-3/4"></div>
                    <div class="flex gap-3 mt-3">
                        <div class="skeleton-line w-1/4"></div>
                        <div class="skeleton-line w-1/4"></div>
                        <div class="skeleton-line w-1/4"></div>
                    </div>
                `;
                elements.tenderList.appendChild(skeleton);
            }
        }

        // 显示错误提示
        function showErrorToast(message) {
            // 移除已存在的提示
            const existingToast = document.querySelector('.error-toast');
            if (existingToast) {
                existingToast.remove();
            }

            const toast = document.createElement('div');
            toast.className = 'error-toast';
            toast.innerHTML = `
                <div class="flex items-center gap-2">
                    <i class="fa fa-exclamation-circle"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(toast);

            // 3秒后自动移除
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // 设置加载状态
        function setLoading(isLoading) {
            appState.isLoading = isLoading;
        }

        // 显示/隐藏空状态
        function showEmptyState(show) {
            if (show) {
                // 创建空状态元素（如果不存在）
                if (!elements.emptyState) {
                    const emptyState = document.createElement('li');
                    emptyState.id = 'emptyState';
                    emptyState.className = 'py-16 text-center';
                    emptyState.innerHTML = `
                        <div class="w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center">
                            <i class="fa fa-search text-3xl text-gray-300"></i>
                        </div>
                        <p class="text-neutral">暂无匹配的招标信息</p>
                        <button id="reloadBtn" class="mt-4 px-4 py-2 bg-primary text-white rounded-lg text-sm">
                            重新加载
                        </button>
                    </div>
                    `;
                    elements.emptyState = emptyState;
                    elements.reloadBtn = document.getElementById('reloadBtn');
                }
                
                elements.tenderList.innerHTML = '';
                elements.tenderList.appendChild(elements.emptyState);
                
                // 添加重新加载按钮事件
                if (elements.reloadBtn) {
                    elements.reloadBtn.addEventListener('click', function() {
                        loadInitialData();
                    });
                }
            } else if (elements.emptyState && elements.emptyState.parentNode) {
                elements.tenderList.removeChild(elements.emptyState);
            }
        }

        // 更新筛选标签显示
        function updateFilterTags() {
            // 控制标签容器显示/隐藏
            const hasFilters = appState.selectedArea || appState.activeFilter !== 'all' || appState.searchQuery.trim();
            elements.filterTags.classList.toggle('hidden', !hasFilters);

            // 更新地区标签
            elements.areaTag.classList.toggle('hidden', !appState.selectedArea);
            if (appState.selectedArea) {
                elements.areaTagText.textContent = appState.selectedArea;
            }

            // 更新日期标签
            elements.dateTag.classList.toggle('hidden', appState.activeFilter === 'all');
            if (appState.activeFilter !== 'all') {
                const filterLabels = {
                    'today': '今天'
                    // 'week': '本周',
                    // 'month': '本月',
                    // 'threeMonths': '三个月内',
                    // 'all': '全部'
                };
                elements.dateTagText.textContent = filterLabels[appState.activeFilter] || '全部';
            }

            // 更新是否还有更多数据
            appState.hasMore = appState.currentPage * appState.itemsPerPage < appState.totalItems;
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 搜索输入
            elements.searchInput.addEventListener('input', debounce(function () {
                appState.searchQuery = this.value;
                appState.currentPage = 1;
                loadInitialData();
            }, 500));

            // 地区筛选下拉框变化
            elements.areaSelect.addEventListener('change', function () {
                appState.selectedArea = this.value;
                appState.currentPage = 1;
                loadInitialData();
            });

            // 刷新按钮
            elements.refreshBtn.addEventListener('click', function () {
                loadInitialData();
            });

            // 筛选按钮（日期筛选面板）
            elements.filterBtn.addEventListener('click', function () {
                elements.filterPanel.classList.toggle('hidden');
            });

            // 日期筛选
            elements.dateFilters.forEach(button => {
                button.addEventListener('click', function () {
                    // 更新按钮样式
                    elements.dateFilters.forEach(btn => {
                        btn.classList.remove('active');
                        btn.className = 'date-filter px-3 py-1 rounded-full text-sm bg-gray-100 text-neutral hover:bg-gray-200 transition-colors';
                    });
                    this.classList.add('active');

                    // 设置筛选条件
                    const filterType = this.dataset.filter;
                    appState.activeFilter = filterType;
                    appState.currentPage = 1;

                    // 设置日期范围 (使用LocalDate格式)
                    const today = new Date();

                    switch (filterType) {
                        case 'today':
                            appState.filterStartDate = formatDateForApi(today);
                            appState.filterEndDate = formatDateForApi(today);
                            break;
                        case 'week':
                            const firstDay = new Date(today);
                            firstDay.setDate(today.getDate() - 6);
                            const lastDay = new Date(today);
                            appState.filterStartDate = formatDateForApi(firstDay);
                            appState.filterEndDate = formatDateForApi(lastDay);
                            break;
                        case 'month':
                            const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
                            const lastDayOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                            appState.filterStartDate = formatDateForApi(firstDayOfMonth);
                            appState.filterEndDate = formatDateForApi(lastDayOfMonth);
                            break;
                        case 'threeMonths':
                            const threeMonthsAgo = new Date();
                            threeMonthsAgo.setMonth(today.getMonth() - 3);
                            appState.filterStartDate = formatDateForApi(threeMonthsAgo);
                            appState.filterEndDate = formatDateForApi(today);
                            break;
                        default:
                            appState.filterStartDate = null;
                            appState.filterEndDate = null;
                    }

                    loadInitialData();
                });
            });

            // 格式化日期为API所需格式 (yyyy-MM-dd)
            function formatDateForApi(date) {
                return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
            }

            // 清除地区筛选
            elements.areaTagClose.addEventListener('click', function () {
                appState.selectedArea = '';
                elements.areaSelect.value = '';
                appState.currentPage = 1;
                loadInitialData();
            });

            // 清除日期筛选
            elements.dateTagClose.addEventListener('click', function () {
                appState.activeFilter = 'all';
                appState.filterStartDate = null;
                appState.filterEndDate = null;
                // 重置日期筛选按钮样式
                elements.dateFilters.forEach(btn => {
                    btn.classList.remove('active');
                    btn.className = 'date-filter px-3 py-1 rounded-full text-sm bg-gray-100 text-neutral hover:bg-gray-200 transition-colors';
                });
                document.querySelector('[data-filter="all"]').classList.add('active');
                appState.currentPage = 1;
                loadInitialData();
            });

            // 清除全部筛选
            elements.clearAllFilters.addEventListener('click', function () {
                appState.selectedArea = '';
                appState.searchQuery = '';
                appState.activeFilter = 'all';
                appState.filterStartDate = null;
                appState.filterEndDate = null;
                appState.currentPage = 1;

                // 重置UI
                elements.areaSelect.value = '';
                elements.searchInput.value = '';
                elements.dateFilters.forEach(btn => {
                    btn.classList.remove('active');
                    btn.className = 'date-filter px-3 py-1 rounded-full text-sm bg-gray-100 text-neutral hover:bg-gray-200 transition-colors';
                });
                document.querySelector('[data-filter="all"]').classList.add('active');

                loadInitialData();
            });

            // 回到顶部按钮
            elements.backToTopBtn.addEventListener('click', function () {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });

            // 滚动事件
            window.addEventListener('scroll', function () {
                // 计算滚动百分比
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrollPercentage = (scrollTop / scrollHeight) * 100;

                // 更新滚动指示器
                elements.scrollIndicator.style.width = `${scrollPercentage}%`;

                // 控制回到顶部按钮显示
                if (scrollTop > 300) {
                    elements.backToTopBtn.classList.remove('opacity-0', 'invisible');
                    elements.backToTopBtn.classList.add('opacity-100', 'visible');
                } else {
                    elements.backToTopBtn.classList.add('opacity-0', 'invisible');
                    elements.backToTopBtn.classList.remove('opacity-100', 'visible');
                }

                // 检测是否滚动到底部
                const bottomOffset = 100;
                if (window.innerHeight + window.scrollY >= document.body.offsetHeight - bottomOffset) {
                    loadMoreData();
                }
            });
        }

        // 防抖函数
        function debounce(func, delay) {
            let timeout;
            return function () {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(context, args), delay);
            };
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>